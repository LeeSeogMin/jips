
=== 20NG Metric Validation ===

================================================================================
Loading 20 Newsgroups Dataset
================================================================================

Dataset Statistics:
  Total documents: 1000
  Category distribution:
    - Computer: 200 docs
    - Recreation: 200 docs
    - Science: 200 docs
    - Politics/Religion: 200 docs
    - Miscellaneous: 200 docs

================================================================================
Running CTE Topic Model (K=5 topics, 10 keywords)
================================================================================

Loading all-MiniLM-L6-v2 embeddings...
Computing document embeddings...
Batches:   0%|          | 0/32 [00:00<?, ?it/s]Batches:   3%|▎         | 1/32 [00:00<00:17,  1.79it/s]Batches:   6%|▋         | 2/32 [00:01<00:15,  1.90it/s]Batches:   9%|▉         | 3/32 [00:01<00:15,  1.92it/s]Batches:  12%|█▎        | 4/32 [00:02<00:14,  1.94it/s]Batches:  16%|█▌        | 5/32 [00:02<00:13,  1.95it/s]Batches:  19%|█▉        | 6/32 [00:03<00:13,  1.99it/s]Batches:  22%|██▏       | 7/32 [00:03<00:12,  1.97it/s]Batches:  25%|██▌       | 8/32 [00:04<00:12,  1.97it/s]Batches:  28%|██▊       | 9/32 [00:04<00:11,  1.95it/s]Batches:  31%|███▏      | 10/32 [00:05<00:11,  1.95it/s]Batches:  34%|███▍      | 11/32 [00:05<00:10,  1.94it/s]Batches:  38%|███▊      | 12/32 [00:06<00:10,  1.96it/s]Batches:  41%|████      | 13/32 [00:06<00:09,  1.94it/s]Batches:  44%|████▍     | 14/32 [00:07<00:08,  2.10it/s]Batches:  47%|████▋     | 15/32 [00:07<00:08,  2.12it/s]Batches:  50%|█████     | 16/32 [00:08<00:07,  2.06it/s]Batches:  53%|█████▎    | 17/32 [00:08<00:06,  2.33it/s]Batches:  56%|█████▋    | 18/32 [00:08<00:05,  2.66it/s]Batches:  59%|█████▉    | 19/32 [00:08<00:04,  2.86it/s]Batches:  62%|██████▎   | 20/32 [00:09<00:03,  3.04it/s]Batches:  66%|██████▌   | 21/32 [00:09<00:03,  3.52it/s]Batches:  69%|██████▉   | 22/32 [00:09<00:02,  4.01it/s]Batches:  72%|███████▏  | 23/32 [00:09<00:02,  4.13it/s]Batches:  75%|███████▌  | 24/32 [00:09<00:01,  4.68it/s]Batches:  78%|███████▊  | 25/32 [00:10<00:01,  4.74it/s]Batches:  81%|████████▏ | 26/32 [00:10<00:01,  4.93it/s]Batches:  88%|████████▊ | 28/32 [00:10<00:00,  6.58it/s]Batches:  91%|█████████ | 29/32 [00:10<00:00,  6.64it/s]Batches: 100%|██████████| 32/32 [00:10<00:00,  2.99it/s]
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:httpx:HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cpu
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: all-MiniLM-L6-v2
C:\jips\venv\Lib\site-packages\numpy\core\fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
C:\jips\venv\Lib\site-packages\numpy\core\_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
  ret = ret.dtype.type(ret / rcount)

Tokenizing texts...
Building keyword embedding map...
  Total unique words: 16214

Fitting CTE model...
[WARNING] Failed to initialize evaluators: No module named 'newsgroup.StatEvaluator'
[DEBUG] CTE 모델 학습 시작 (총 1000개 문서)
[DEBUG] 클러스터링 수행 중...
[DEBUG] 벡터라이저 초기화 중...
[DEBUG] TF-IDF 행렬 생성 중...
[DEBUG] 단어 빈도 계산 중...
[DEBUG] Extracting topic keywords with batched processing...
[DEBUG] Embeddings shape: torch.Size([1000, 384])
[DEBUG] Processing topic 1/5
[DEBUG] Processing topic 2/5
[DEBUG] Processing topic 3/5
[DEBUG] Processing topic 4/5
[DEBUG] Processing topic 5/5
[DEBUG] CTE 모델 학습 완료

Extracted 5 topics:
  Topic 1: canucks, braves, bullpen, cubs, baseman, baseball, divisional, baseballs, bruins, dodgers
  Topic 2: cheap, cost, cheaply, cheapest, deals, auction, bids, costs, budget, buy
  Topic 3: ebcdic, dxcomm, aixwindows, amigavision, bcmp, cplab, cstom, cxm, dos, digitized
  Topic 4: condemning, atheism, advocating, contradictions, blindly, disbelievers, contradictory, contemptibly, dissent, debated
  Topic 5: chipset, chipsets, amigavision, dell, cdware, cheap, compat, cheapest, emulator, amiga

-- LLM Alignment by Provider (Coherence) --
   LLM Spearman_Stat Spearman_Sem PW_Stat PW_Sem LLM_AvgCoh
Claude        -0.108        0.000   0.500  0.000      0.786
OpenAI        -0.105        0.000   0.400  0.000      0.772
  Grok         0.079        0.000   0.400  0.000      0.720

-- Label-based Separation --
Silhouette (cosine): 0.055
NMI: 0.363, ARI: 0.292

-- Stability (Bootstrap CV of Coherence) --
CV Stat: 49.9%, CV Sem: 0.0%

-- Basic Evaluation Results --
Statistical Method:
  Overall Coherence: 0.493
  Overall Distinctiveness: 0.000
  Overall Diversity: 1.000

Semantic Method:
  Overall Coherence: nan
  Overall Distinctiveness: 0.000
  Overall Diversity: 1.000

LLM Methods:
  Claude Overall Coherence: 0.786
  OpenAI Overall Coherence: 0.772
  Grok Overall Coherence: 0.720
Traceback (most recent call last):
  File "C:\jips\newsgroup\metrics_validation.py", line 224, in <module>
    main()
  File "C:\jips\newsgroup\metrics_validation.py", line 210, in main
    df_summary = pd.DataFrame({
                 ^^^^^^^^^^^^^^
  File "C:\jips\venv\Lib\site-packages\pandas\core\frame.py", line 782, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\jips\venv\Lib\site-packages\pandas\core\internals\construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\jips\venv\Lib\site-packages\pandas\core\internals\construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\jips\venv\Lib\site-packages\pandas\core\internals\construction.py", line 630, in _homogenize
    com.require_length_match(val, index)
  File "C:\jips\venv\Lib\site-packages\pandas\core\common.py", line 573, in require_length_match
    raise ValueError(
ValueError: Length of values (0) does not match length of index (5)
